{"version":3,"sources":["../../../src/sqlite-core/query-builders/raw.ts"],"sourcesContent":["import { entityKind } from '~/entity.ts';\nimport type { SQL, SQLWrapper } from '~/index.ts';\nimport { QueryPromise } from '~/query-promise.ts';\nimport type { RunnableQuery } from '~/runnable-query.ts';\nimport type { PreparedQuery } from '~/session.ts';\nimport type { SQLiteAsyncDialect } from '../dialect.ts';\n\ntype SQLiteRawAction = 'all' | 'get' | 'values' | 'run';\nexport interface SQLiteRawConfig {\n\taction: SQLiteRawAction;\n}\n\nexport class SQLiteRaw<TResult> extends QueryPromise<TResult> implements RunnableQuery<TResult, 'sqlite'>, SQLWrapper {\n\tstatic readonly [entityKind]: string = 'SQLiteRaw';\n\n\tdeclare readonly _: {\n\t\treadonly dialect: 'sqlite';\n\t\treadonly result: TResult;\n\t};\n\n\t/** @internal */\n\tconfig: SQLiteRawConfig;\n\n\tconstructor(\n\t\tprivate cb: () => Promise<TResult>,\n\t\tprivate getSQLCb: () => SQL,\n\t\taction: SQLiteRawAction,\n\t\tprivate dialect: SQLiteAsyncDialect,\n\t\tprivate mapBatchResult: (result: unknown) => unknown,\n\t) {\n\t\tsuper();\n\t\tthis.config = { action };\n\t}\n\n\t/** @internal */\n\tgetSQL(): SQL {\n\t\treturn this.getSQLCb();\n\t}\n\n\toverride async execute(): Promise<TResult> {\n\t\treturn this.cb();\n\t}\n\n\tprepare(): PreparedQuery {\n\t\treturn {\n\t\t\tgetQuery: () => {\n\t\t\t\treturn this.dialect.sqlToQuery(this.getSQL());\n\t\t\t},\n\t\t\tmapResult: (result: unknown, isFromBatch?: boolean) => {\n\t\t\t\treturn isFromBatch ? this.mapBatchResult(result) : result;\n\t\t\t},\n\t\t};\n\t}\n}\n"],"mappings":"AAAA,SAAS,kBAAkB;AAE3B,SAAS,oBAAoB;AAUtB,MAAM,kBAA2B,aAA8E;AAAA,EAWrH,YACS,IACA,UACR,QACQ,SACA,gBACP;AACD,UAAM;AANE;AACA;AAEA;AACA;AAGR,SAAK,SAAS,EAAE,OAAO;AAAA,EACxB;AAAA,EAnBA,QAAiB,UAAU,IAAY;AAAA;AAAA,EAQvC;AAAA;AAAA,EAcA,SAAc;AACb,WAAO,KAAK,SAAS;AAAA,EACtB;AAAA,EAEA,MAAe,UAA4B;AAC1C,WAAO,KAAK,GAAG;AAAA,EAChB;AAAA,EAEA,UAAyB;AACxB,WAAO;AAAA,MACN,UAAU,MAAM;AACf,eAAO,KAAK,QAAQ,WAAW,KAAK,OAAO,CAAC;AAAA,MAC7C;AAAA,MACA,WAAW,CAAC,QAAiB,gBAA0B;AACtD,eAAO,cAAc,KAAK,eAAe,MAAM,IAAI;AAAA,MACpD;AAAA,IACD;AAAA,EACD;AACD;","names":[]}